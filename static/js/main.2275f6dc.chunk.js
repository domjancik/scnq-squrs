(this.webpackJsonpsqurs=this.webpackJsonpsqurs||[]).push([[2],{46:function(e,t,n){},47:function(e,t,n){},57:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var r,c=n(3),i=n.n(c),o=n(37),a=n.n(o),u=(n(46),n(47),n(5)),s=n(27),l=n(14),b=(n(57),{apiKey:"AIzaSyA6miG1egwhyCpNcBdr-R8P3flUJP8VLj4",authDomain:"squr-d2ae8.firebaseapp.com",databaseURL:"https://squr-d2ae8-default-rtdb.europe-west1.firebasedatabase.app",projectId:"squr-d2ae8",storageBucket:"squr-d2ae8.appspot.com",messagingSenderId:"25610237851",appId:"1:25610237851:web:8b825f5e7ab2363cd2533e"}),d=n(38),v=n(12),f=n(13),j=n(1),h=n(10),O=n(7),p=Object(f.a)(r||(r=Object(v.a)(["\n    border-radius: 0.5em;\n    padding: 0.5em;\n    box-sizing: border-box;\n    box-shadow: inset 0em -.2em .5em #abc;\n    background: transparent;\n    color: #abc;\n    border: none;\n    font-family: 'JetBrains Mono', monospace;\n\n    /* transition: all 100ms; */\n\n    &:hover {\n        box-shadow: inset 0em .2em .5em #abc;\n    }\n"])));var m,x,g=function(e){var t=e.children,n=Object(h.a)(e,["children"]);return Object(O.b)("button",Object(j.a)(Object(j.a)({css:p},n),{},{children:t}))},w=Object(f.a)(m||(m=Object(v.a)(["\n    position: fixed;\n    left: 2em;\n    top: 2em;\n"]))),y=Object(f.a)(x||(x=Object(v.a)(["\n    background: rgba(0,0,0, 0.5);\n    color: #abc;\n    border-radius: 0.5em;\n    padding: 1em;\n    pointer-events: none;\n"]))),C=[{title:"t",value:"time in secs"},{title:"i",value:"index of squr - 0, 1, 2... use i1 for 1-indexed"},{title:"x",value:"x index of squr, use x1 for 1-indexed"},{title:"y",value:"y index of squr, use y1 for 1-indexed"}],k=[{title:"sin(x)",value:"sine with 0-1 cycle input and 0-1 output"},{title:"tri(x)",value:"triangle with 0-1 cycle input and 0-1 output"},{title:"sqr(x, phase?)",value:"square with 0-1 cycle input, optional phase"},{title:"stp(x, a, b, c, ...)",value:"step sequencer with 0-1 cycle input"}],E=function(e){var t=e.map((function(e){var t=e.title,n=e.value;return Object(O.c)("li",{children:[Object(O.c)("strong",{children:[t,":"]})," ",n]},t+n)}));return Object(O.b)("ul",{children:t})};var S,q=function(e){Object(d.a)(e);var t=Object(c.useState)(!1),n=Object(u.a)(t,2),r=n[0],i=n[1],o=Object(O.c)("div",{css:y,children:[Object(O.b)("p",{children:"make the squrs sing and shine with math expressions and clicks"}),Object(O.b)("p",{children:"all is syncd, tell friends"}),Object(O.b)("p",{children:"RIGHT CLICK switches instruments"}),Object(O.b)("h3",{children:"Variables"}),E(C),Object(O.b)("h3",{children:"Functions"}),E(k)]});return Object(O.c)("div",{css:w,children:[Object(O.b)("div",{children:Object(O.b)(g,{onClick:function(){return i((function(e){return!e}))},children:"Help pls"})}),r&&o]})},M=Object(f.a)(S||(S=Object(v.a)(["\n    color: white;\n    text-align: center;\n"])));var R=function(e){var t=e.onClick;return Object(O.c)("div",{css:M,children:[Object(O.b)("h1",{children:"SQUR!"}),Object(O.b)("div",{children:Object(O.b)(g,{onClick:t,children:"\u25a1\u25a1 start \u25a1\u25a1"})}),Object(O.b)("div",{children:Object(O.b)("small",{children:"gotta make you click to make sounds, aight, domj"})})]})},A=Object(c.createContext)({volume:null}),F=n(8);var L=function(e){var t=e.children,n=Object(c.useRef)(1);return Object(c.useEffect)((function(){return window.setVolume=function(e){return n.current=e},function(){delete window.setVolume}}),[]),Object(F.jsx)(A.Provider,{value:{volume:n},children:t})},B=n(11),I=function(e){return{width:e,height:e}};var T=function(e){var t=e.palette,n=e.children,r=e.side,c=e.onContextMenu,i=Object(h.a)(e,["palette","children","side","onContextMenu"]);return Object(F.jsx)("div",Object(j.a)(Object(j.a)({onContextMenu:c,style:Object(j.a)(Object(j.a)(Object(j.a)({},{position:"relative",borderRadius:"0.5em",padding:"0.5em",boxSizing:"border-box",boxShadow:"inset 0em -.2em .5em #abc"}),I(r)),t)},i),{},{children:n}))},N=(n(24),n(39),function(e){var t=i.a.useRef(),n=i.a.useRef(),r=function r(c){if(n.current){var i=c-n.current;e(i)}n.current=c,t.current=requestAnimationFrame(r)};i.a.useEffect((function(){return t.current=requestAnimationFrame(r),function(){return cancelAnimationFrame(t.current)}}),[])});var P,D=function(e){var t=e.value,n=Object(c.useRef)(Array(30).fill(0)),r=Object(c.useState)(n.current),i=Object(u.a)(r,2),o=i[0],a=i[1],s=Object(c.useRef)(0);s.current=t,N((function(){n.current=n.current.slice(1,n.current.length),n.current.push(s.current),a(n.current)}));var l=o.map((function(e,t){return"L".concat(1*t," ").concat(100-(90*(Math.abs(e)||0)+5))})).join(" ");return Object(F.jsx)("div",{style:{width:"100%"},children:Object(F.jsx)("svg",{height:"30",width:"100%",viewBox:"0 0 30 100",preserveAspectRatio:"none",children:Object(F.jsx)("path",{d:"M-5 0 ".concat(l),strokeWidth:"2",stroke:"currentColor",fill:"none",vectorEffect:"non-scaling-stroke"})})})},V=Object(f.a)(P||(P=Object(v.a)(["\n  opacity: 0.3;\n  transition: all 500ms;\n  &:hover {\n    opacity: 1;\n  }\n"])));var z=function(e){var t=e.expression,n=e.setExpression,r=e.res,c=e.fontColor;return Object(O.c)(O.a,{children:[Object(O.b)("textarea",{style:{fontFamily:"JetBrains Mono, monospace",borderRadius:"0.3em",padding:"0.5em",boxSizing:"border-box",border:"none",width:"100%",boxShadow:"inset 0em .2em .5em #abc",background:"transparent",color:c,fontWeight:"bold",transition:"all 300ms",maxWidth:"100%",minWidth:"100%",minHeight:"50%",maxHeight:"100%"},value:t,onChange:function(e){return n(e.target.value)}}),Object(O.b)("div",{css:V,style:{color:c,fontSize:"0.5em"},children:Object(O.b)(D,{value:r})})]})},J=n(26),G=function(e){return Math.sin(e*Math.PI*2)/2+.5},H=function(e){return e%1<.5?e%1*2:1-2*(e%1-.5)},W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return e%1>t?1:0},U=function(e){return 1-e},K=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return e*U(n)+t*n},Q=function(e){var t=arguments.length<=1?0:arguments.length-1,n=Math.floor(e*t)%t;return n+1<1||arguments.length<=n+1?void 0:arguments[n+1]},X="C",Y="F",Z="G",$="Bb",_=[X,"D",Y,Z,"A"],ee=[{title:"Major Pentatonic (5)",notes:[X,"D","E",Z,"A"]},{title:"Egyptian Suspended (5)",notes:[X,"D",Y,Z,$]},{title:"Blues Major Ritsusen (5)",notes:_},{title:"Blues Minor Man Gong (5)",notes:[X,"Eb",Y,"Ab",$]},{title:"Blues Minor Pentatonic (5)",notes:[X,"Eb",Y,Z,$]},{title:"ToneJS Sequencer Example (4)",notes:["A","Db","E","Gb"]}],te=_;window.sqursSetScale=function(e){var t=ee[e%ee.length];console.log("Changing to scale ".concat(t.title)),te=t.notes};var ne=function(e){var t=te[e%te.length],n=Math.floor(e/te.length);return"".concat(t).concat(n+3)},re=function(e,t,n){var r=Object(c.useContext)(A).volume,i=Object(c.useState)(0),o=Object(u.a)(i,2),a=o[0],s=o[1];N((function(e){s(f.current)}));var b=Object(c.useRef)((function(){return.5})),d=Object(c.useRef)(null);Object(c.useEffect)((function(){try{b.current=Object(J.a)(e),d.current=null}catch(t){d.current=t}}),[e]);var v,f=Object(c.useRef)(0),h=(v=(null===n||void 0===n?void 0:n.i)||0,l.a(ne(v)).toFrequency());Object(c.useEffect)((function(){return O.current=new l.c({frequency:h,type:"sine",volume:-60,detune:30*Math.random()-15}).toDestination().start(),function(){var e;null===(e=O.current)||void 0===e||e.dispose()}}),[h]);var O=Object(c.useRef)(null);return Object(c.useEffect)((function(){var e=new l.b((function(e){var t,c=b.current(Object(j.a)({time:e,t:e,sin:G,tri:H,sqr:W,stp:Q,inv:U},n));if(f.current="number"===typeof c?(t=c,Math.max(Math.min(t,1),-1)):0,!isNaN(f.current)&&O.current&&r){var i=0===f.current?-1/0:K(-60,K(-60,-40,r.current),Math.abs(f.current));O.current&&(O.current.volume.rampTo(i,.06,e),O.current.type=f.current>=0?"sine":"square")}}),"0.03").start(0);return function(){var t;null===(t=O.current)||void 0===t||t.dispose(),e.dispose()}}),[]),{res:Math.abs(a),error:d.current,instrumentName:"expsyn"}},ce=n(6),ie="#abc";function oe(e){var t=e.res,n=e.value,r=e.onClick,c=e.side,i=e.active,o="0";n>=.5&&(o="?"),n>=1&&(o="!");var a=i?ie:"transparent",u=i?"black":t>.5?"rgba(0,0,0,0.1)":"#abc";return Object(F.jsx)(g,{onClick:r,style:{width:c,height:c,background:a,color:u,borderRadius:"100%"},children:o})}var ae={gridseq:{view:function(e){var t=e.res,n=e.expression,r=e.setExpression,c=e.side,i=e.extra,o=(null===i||void 0===i?void 0:i.step)||0,a=n.split(",").map((function(e){var t=+e;return isNaN(t)?0:t}))||[0],u=function(e){!function(e,t){var n=Object(ce.a)(a);n[e]=t,r(n.join(","))}(e,(a[e]+.5)%1.5)},s="calc(".concat(c," / 4 - 5px)"),l=a.map((function(e,n){return Object(F.jsx)(oe,{res:t,active:o===n,side:s,value:e,onClick:function(){return u(n)}},n)}));return Object(F.jsx)("div",{style:{textAlign:"center"},children:l})},logic:function(e,t,n){var r=Object(c.useRef)([0]),i=Object(c.useState)(0),o=Object(u.a)(i,2),a=o[0],s=o[1];Object(c.useEffect)((function(){var n=e.split(",").map((function(e){var t=+e;return isNaN(t)?0:t}));r.current=n||[0],r.current.length<16&&t("0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0")}),[e,t]);var b=Object(c.useState)(0),d=Object(u.a)(b,2),v=d[0],f=d[1],j=Object(c.useRef)(null);return Object(c.useEffect)((function(){j.current=(new l.d).toDestination(),j.current.volume.rampTo(-30,0);var e=new l.b((function(e){var t,c=Math.round(4*e)%r.current.length,i=r.current[c];s(c);var o=i>=Math.random();f(o?1:0),o&&(null===(t=j.current)||void 0===t||t.triggerAttackRelease(ne((null===n||void 0===n?void 0:n.i)||0),"8n",e))}),"8n").start(0);return function(){var t;null===(t=j.current)||void 0===t||t.dispose(),e.dispose()}}),[]),{res:v,error:null,instrumentName:"sequencer",extra:{step:a}}}},expsyn:{view:z,logic:re}};var ue=function(e){var t=e.setView,n=e.setLogic;return{title:"Instruments",children:Object.keys(ae).map((function(e){return{title:e,action:function(){return function(e){n&&n(e),t&&t(e)}(e)}}}))}},se="setExpression",le=function(e,t,n){var r=function(e,t){return new CustomEvent(se,{detail:{expression:e,condition:t},bubbles:!0})}(e,t);(null!==n&&void 0!==n?n:document).dispatchEvent(r)};var be=function(e){var t=e.variables,n=e.expression;return{title:"Clone expr",children:[{title:"To All",action:function(){return function(e,t){le(e,void 0,t)}(n)}},{title:"To Row",action:function(){return function(e,t,n){le(e,"y === ".concat(t),n)}(n,(null===t||void 0===t?void 0:t.y)||0)}},{title:"To Column",action:function(){return function(e,t,n){le(e,"x === ".concat(t),n)}(n,(null===t||void 0===t?void 0:t.x)||0)}}]}};var de=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),r=n[0],i=n[1],o=[ue(e),be(e)],a=r.reduce((function(e,t){var n=e[t];return n.children?n.children:e}),o),s=function(e,t){return function(){e.children?i((function(e){return[].concat(Object(ce.a)(e),[t])})):e.action&&e.action()}};return a.map((function(e,t){return Object(F.jsx)(g,{onClick:s(e,t),children:e.title},e.title)}))};var ve=function(e){var t=Object(c.useState)(!1),n=Object(u.a)(t,2),r=n[0],i=n[1];return{handleFlip:function(){i((function(e){return!e}))},ContentComponent:r?de:e}};var fe,je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(c.useEffect)((function(){var n=function(n){var r=n.detail,c=r.condition,i=r.expression;c&&!Object(J.b)(Object(J.c)(c),t)||e(i)};return window.addEventListener("setExpression",n),function(){window.removeEventListener("setExpression",n)}}),[e,t])};function he(e,t,n){var r=Object(c.useState)(e),i=Object(u.a)(r,2),o=i[0],a=i[1];return[null!==t&&void 0!==t?t:o,null!==n&&void 0!==n?n:a]}var Oe=Object(f.a)(fe||(fe=Object(v.a)(["\n  width: calc(100% - 1.3em);\n  position: absolute;\n  bottom: 0.9em;\n  left: 0.6em;\n  font-size: 0.25em;\n"])));var pe=function(e){e.init;var t,n,r,i,o,a=e.side,s=void 0===a?100:a,l=e.expression,b=e.setExpression,d=e.variables,v=void 0===d?{}:d,f=e.contentComponent,h=e.useExpressionHook,p=e.logic,m=e.setLogic,x=e.view,w=e.setView,y=he("0",l,b),C=Object(u.a)(y,2),k=C[0],E=C[1],S=he("expsyn",p,m),q=Object(u.a)(S,2),M=q[0],R=q[1],A=he("expsyn",x,w),F=Object(u.a)(A,2),L=F[0],B=F[1],I=(ae[M]||{logic:re}).logic,N=(ae[L]||{view:z}).view,P=ve(null!==f&&void 0!==f?f:N),D=P.ContentComponent,V=P.handleFlip,J=(null!==h&&void 0!==h?h:I)(k,E,v),G=J.res,H=J.error,W=J.extra,U=Object(c.useState)(1),K=Object(u.a)(U,2),Q=K[0],X=K[1],Y=G,Z=Y*Q<.5?"#abc":"#444",$=Y*Q>0?(t=Y,{background:"rgba(".concat("170, 187, 204",", ").concat(t,")")}):function(e){return{background:"rgba(0,0,0, ".concat(e,")")}}(-Y);return je(E,v),Object(O.c)(T,Object(j.a)(Object(j.a)({palette:$,side:s},(n=Q,r=X,i=0,o=1,{onTouchStart:function(){return r(n===o?i:o)}})),{},{children:[Object(O.b)(D,{side:s,expression:k,setExpression:E,res:Y,fontColor:Z,variables:v,error:H,logic:M,setLogic:R,view:L,setView:B,extra:W}),Object(O.b)(g,{css:Oe,onClick:V,children:"flip"})]}))},me=(n(64),Object.keys(ae)[0]),xe=Object.keys(ae)[0];var ge=function(e){var t=e.side,n=void 0===t?100:t,r=e.path,i=void 0===r?"/squr":r,o=Object(h.a)(e,["side","path"]),a=Object(s.b)().ref(i),l=Object(s.c)(a),b=l.data,d=l.status,v=Object(c.useState)(void 0),f=Object(u.a)(v,2),O=f[0],p=f[1],m=Object(c.useState)(void 0),x=Object(u.a)(m,2),g=x[0],w=x[1],y=Object(c.useState)(void 0),C=Object(u.a)(y,2),k=C[0],E=C[1],S=function(e,t){return function(n){e(n),a.update(Object(B.a)({},t,n))}},q=S(p,"expr"),M=S(w,"logic"),R=S(E,"view");return Object(c.useEffect)((function(){if("success"===d){var e,t,n,r=null!==(e=b.expr)&&void 0!==e?e:"sin(t)",c=null!==(t=b.logic)&&void 0!==t?t:me,i=null!==(n=b.view)&&void 0!==n?n:xe;r!==O&&p(r),c!==g&&w(c),i!==k&&E(i)}}),[d,b]),void 0===O||"success"!==d?Object(F.jsx)(T,{side:n,palette:{background:"black"},children:d}):Object(F.jsx)(pe,Object(j.a)({side:n,expression:O,setExpression:q,logic:g,setLogic:M,view:k,setView:R},o),function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"view";return"".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"logic","-").concat(e)}(g,k))},we=i.a.createContext(0),ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Object(c.useState)(e),n=Object(u.a)(t,2),r=n[0],i=n[1];return N((function(e){return i((function(t){return t+e/1e3}))})),r},Ce="".concat(20,"vmin"),ke=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return e%t},Ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return Math.floor(e/t)},Se=new Array(16).fill(1).map((function(e,t){return Object(F.jsx)(ge,{side:Ce,path:"/squrs/".concat(t),variables:{i:t,i1:t+1,x:ke(t),x1:ke(t)+1,y:Ee(t),y1:Ee(t)+1}},t)}));var qe=function(){var e=ye(),t=Object(c.useState)(!1),n=Object(u.a)(t,2),r=n[0],i=n[1];return Object(F.jsx)(s.a,{firebaseConfig:b,children:Object(F.jsx)(L,{children:Object(F.jsx)(we.Provider,{value:e,children:Object(F.jsx)("div",{style:{display:"flex",height:"100vh",width:"100vw",alignItems:"center",justifyContent:"center"},children:r?Object(F.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(4,", ").concat(Ce,")"),gap:"2vmin"},children:[Object(F.jsx)(q,{}),Se]}):Object(F.jsx)(R,{onClick:function(){i(!0),l.f(),l.e.start()}})})})})})},Me=function(e){e&&e instanceof Function&&n.e(12).then(n.bind(null,74)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),i(e),o(e)}))};a.a.render(Object(F.jsx)(i.a.StrictMode,{children:Object(F.jsx)(qe,{})}),document.getElementById("root")),Me()}},[[67,3,4]]]);
//# sourceMappingURL=main.2275f6dc.chunk.js.map