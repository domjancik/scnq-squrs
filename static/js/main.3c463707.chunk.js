(this.webpackJsonpsqurs=this.webpackJsonpsqurs||[]).push([[2],{46:function(e,t,n){},47:function(e,t,n){},57:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var r,c=n(3),i=n.n(c),o=n(37),a=n.n(o),u=(n(46),n(47),n(5)),s=n(27),l=n(14),b=(n(57),{apiKey:"AIzaSyA6miG1egwhyCpNcBdr-R8P3flUJP8VLj4",authDomain:"squr-d2ae8.firebaseapp.com",databaseURL:"https://squr-d2ae8-default-rtdb.europe-west1.firebasedatabase.app",projectId:"squr-d2ae8",storageBucket:"squr-d2ae8.appspot.com",messagingSenderId:"25610237851",appId:"1:25610237851:web:8b825f5e7ab2363cd2533e"}),d=n(38),v=n(12),f=n(13),j=n(1),h=n(10),O=n(7),p=Object(f.a)(r||(r=Object(v.a)(["\n    border-radius: 0.5em;\n    padding: 0.5em;\n    box-sizing: border-box;\n    box-shadow: inset 0em -.2em .5em #abc;\n    background: transparent;\n    color: #abc;\n    border: none;\n    font-family: 'JetBrains Mono', monospace;\n\n    /* transition: all 100ms; */\n\n    &:hover {\n        box-shadow: inset 0em .2em .5em #abc;\n    }\n"])));var m,x,g=function(e){var t=e.children,n=Object(h.a)(e,["children"]);return Object(O.b)("button",Object(j.a)(Object(j.a)({css:p},n),{},{children:t}))},w=Object(f.a)(m||(m=Object(v.a)(["\n    position: fixed;\n    left: 2em;\n    top: 2em;\n"]))),y=Object(f.a)(x||(x=Object(v.a)(["\n    background: rgba(0,0,0, 0.5);\n    color: #abc;\n    border-radius: 0.5em;\n    padding: 1em;\n    pointer-events: none;\n"]))),C=[{title:"t",value:"time in secs"},{title:"i",value:"index of squr - 0, 1, 2... use i1 for 1-indexed"},{title:"x",value:"x index of squr, use x1 for 1-indexed"},{title:"y",value:"y index of squr, use y1 for 1-indexed"}],k=[{title:"sin(x)",value:"sine with 0-1 cycle input and 0-1 output"},{title:"tri(x)",value:"triangle with 0-1 cycle input and 0-1 output"},{title:"sqr(x, phase?)",value:"square with 0-1 cycle input, optional phase"},{title:"stp(x, a, b, c, ...)",value:"step sequencer with 0-1 cycle input"}],S=function(e){var t=e.map((function(e){var t=e.title,n=e.value;return Object(O.c)("li",{children:[Object(O.c)("strong",{children:[t,":"]})," ",n]},t+n)}));return Object(O.b)("ul",{children:t})};var E,q=function(e){Object(d.a)(e);var t=Object(c.useState)(!1),n=Object(u.a)(t,2),r=n[0],i=n[1],o=Object(O.c)("div",{css:y,children:[Object(O.b)("p",{children:"make the squrs sing and shine with math expressions and clicks"}),Object(O.b)("p",{children:"all is syncd, tell friends"}),Object(O.b)("p",{children:"RIGHT CLICK switches instruments"}),Object(O.b)("h3",{children:"Variables"}),S(C),Object(O.b)("h3",{children:"Functions"}),S(k)]});return Object(O.c)("div",{css:w,children:[Object(O.b)("div",{children:Object(O.b)(g,{onClick:function(){return i((function(e){return!e}))},children:"Help pls"})}),r&&o]})},R=Object(f.a)(E||(E=Object(v.a)(["\n    color: white;\n    text-align: center;\n"])));var M=function(e){var t=e.onClick;return Object(O.c)("div",{css:R,children:[Object(O.b)("h1",{children:"SQUR!"}),Object(O.b)("div",{children:Object(O.b)(g,{onClick:t,children:"\u25a1\u25a1 start \u25a1\u25a1"})}),Object(O.b)("div",{children:Object(O.b)("small",{children:"gotta make you click to make sounds, aight, domj"})})]})},F=Object(c.createContext)({volume:null}),L=n(8);var A=function(e){var t=e.children,n=Object(c.useRef)(1);return Object(c.useEffect)((function(){return window.setVolume=function(e){return n.current=e},function(){delete window.setVolume}}),[]),Object(L.jsx)(F.Provider,{value:{volume:n},children:t})},I=n(11),T=function(e){return{width:e,height:e}};var N=function(e){var t=e.palette,n=e.children,r=e.side,c=e.onContextMenu,i=Object(h.a)(e,["palette","children","side","onContextMenu"]);return Object(L.jsx)("div",Object(j.a)(Object(j.a)({onContextMenu:c,style:Object(j.a)(Object(j.a)(Object(j.a)({},{position:"relative",borderRadius:"0.5em",padding:"0.5em",boxSizing:"border-box",boxShadow:"inset 0em -.2em .5em #abc"}),T(r)),t)},i),{},{children:n}))},B=(n(24),n(39),function(e){var t=i.a.useRef(),n=i.a.useRef(),r=function r(c){if(n.current){var i=c-n.current;e(i)}n.current=c,t.current=requestAnimationFrame(r)};i.a.useEffect((function(){return t.current=requestAnimationFrame(r),function(){return cancelAnimationFrame(t.current)}}),[])});var V,P=function(e){var t=e.value,n=Object(c.useRef)(Array(30).fill(0)),r=Object(c.useState)(n.current),i=Object(u.a)(r,2),o=i[0],a=i[1],s=Object(c.useRef)(0);s.current=t,B((function(){n.current=n.current.slice(1,n.current.length),n.current.push(s.current),a(n.current)}));var l=o.map((function(e,t){return"L".concat(1*t," ").concat(100-(90*Math.abs(e)+5))})).join(" ");return Object(L.jsx)("div",{style:{width:"100%"},children:Object(L.jsx)("svg",{height:"30",width:"100%",viewBox:"0 0 30 100",preserveAspectRatio:"none",children:Object(L.jsx)("path",{d:"M-5 0 ".concat(l),strokeWidth:"2",stroke:"currentColor",fill:"none",vectorEffect:"non-scaling-stroke"})})})},z=Object(f.a)(V||(V=Object(v.a)(["\n  opacity: 0.3;\n  transition: all 500ms;\n  &:hover {\n    opacity: 1;\n  }\n"])));var D=function(e){var t=e.expression,n=e.setExpression,r=e.res,c=e.fontColor;return Object(O.c)(O.a,{children:[Object(O.b)("textarea",{style:{fontFamily:"JetBrains Mono, monospace",borderRadius:"0.3em",padding:"0.5em",boxSizing:"border-box",border:"none",width:"100%",boxShadow:"inset 0em .2em .5em #abc",background:"transparent",color:c,fontWeight:"bold",transition:"all 300ms",maxWidth:"100%",minWidth:"100%",minHeight:"50%",maxHeight:"100%"},value:t,onChange:function(e){return n(e.target.value)}}),Object(O.b)("div",{css:z,style:{color:c,fontSize:"0.5em"},children:Object(O.b)(P,{value:r})})]})},H=n(26),J=function(e){return Math.sin(e*Math.PI*2)/2+.5},W=function(e){return e%1<.5?e%1*2:1-2*(e%1-.5)},G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return e%1>t?1:0},U=function(e){return 1-e},K=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return e*U(n)+t*n},Q=function(e){var t=arguments.length<=1?0:arguments.length-1,n=Math.floor(e*t)%t;return n+1<1||arguments.length<=n+1?void 0:arguments[n+1]},X="C",Y="F",Z="G",$="Bb",_=[X,"D",Y,Z,$],ee=function(e){var t=_[e%_.length],n=Math.floor(e/_.length);return"".concat(t).concat(n+3)},te=function(e,t,n){var r=Object(c.useContext)(F).volume,i=Object(c.useState)(0),o=Object(u.a)(i,2),a=o[0],s=o[1];B((function(e){s(v.current)}));var b=Object(c.useRef)((function(){return.5})),d=Object(c.useRef)(null);Object(c.useEffect)((function(){try{b.current=Object(H.a)(e),d.current=null}catch(t){d.current=t}}),[e]);var v=Object(c.useRef)(0);Object(c.useEffect)((function(){var e;return f.current=new l.c({frequency:(e=(null===n||void 0===n?void 0:n.i)||0,l.a(ee(e)).toFrequency()),type:"sine",volume:-60,detune:30*Math.random()-15}).toDestination().start(),function(){var e;null===(e=f.current)||void 0===e||e.dispose()}}),[]);var f=Object(c.useRef)(null);return Object(c.useEffect)((function(){var e=new l.b((function(e){var t,c=b.current(Object(j.a)({time:e,t:e,sin:J,tri:W,sqr:G,stp:Q,inv:U},n));if(v.current="number"===typeof c?(t=c,Math.max(Math.min(t,1),-1)):0,!isNaN(v.current)&&f.current&&r){var i=0===v.current?-1/0:K(-60,K(-60,-40,r.current),Math.abs(v.current));f.current.volume.rampTo(i,.06,e),f.current.type=v.current>=0?"sine":"square"}}),"0.03").start(0);return function(){var t;null===(t=f.current)||void 0===t||t.dispose(),e.dispose()}}),[]),{res:Math.abs(a),error:d.current,instrumentName:"expsyn"}},ne=n(6),re="#abc";function ce(e){var t=e.res,n=e.value,r=e.onClick,c=e.side,i=e.active,o="0";n>=.5&&(o="?"),n>=1&&(o="!");var a=i?re:"transparent",u=i?"black":t>.5?"rgba(0,0,0,0.1)":"#abc";return Object(L.jsx)(g,{onClick:r,style:{width:c,height:c,background:a,color:u,borderRadius:"100%"},children:o})}var ie={gridseq:{view:function(e){var t=e.res,n=e.expression,r=e.setExpression,c=e.side,i=e.extra,o=(null===i||void 0===i?void 0:i.step)||0,a=n.split(",").map((function(e){var t=+e;return isNaN(t)?0:t}))||[0],u=function(e){!function(e,t){var n=Object(ne.a)(a);n[e]=t,r(n.join(","))}(e,(a[e]+.5)%1.5)},s="calc(".concat(c," / 4 - 5px)"),l=a.map((function(e,n){return Object(L.jsx)(ce,{res:t,active:o===n,side:s,value:e,onClick:function(){return u(n)}},n)}));return Object(L.jsx)("div",{style:{textAlign:"center"},children:l})},logic:function(e,t,n){var r=Object(c.useRef)([0]),i=Object(c.useState)(0),o=Object(u.a)(i,2),a=o[0],s=o[1];Object(c.useEffect)((function(){var n=e.split(",").map((function(e){var t=+e;return isNaN(t)?0:t}));r.current=n||[0],r.current.length<16&&t("0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0")}),[e,t]);var b=Object(c.useState)(0),d=Object(u.a)(b,2),v=d[0],f=d[1],j=Object(c.useRef)(null);return Object(c.useEffect)((function(){j.current=(new l.d).toDestination(),j.current.volume.rampTo(-30,0);var e=new l.b((function(e){var t,c=Math.round(4*e)%r.current.length,i=r.current[c];s(c);var o=i>=Math.random();f(o?1:0),o&&(null===(t=j.current)||void 0===t||t.triggerAttackRelease(ee((null===n||void 0===n?void 0:n.i)||0),"8n",e))}),"8n").start(0);return function(){var t;null===(t=j.current)||void 0===t||t.dispose(),e.dispose()}}),[]),{res:v,error:null,instrumentName:"sequencer",extra:{step:a}}}},expsyn:{view:D,logic:te}};var oe=function(e){var t=e.setView,n=e.setLogic;return{title:"Instruments",children:Object.keys(ie).map((function(e){return{title:e,action:function(){return function(e){n&&n(e),t&&t(e)}(e)}}}))}},ae="setExpression",ue=function(e,t,n){var r=function(e,t){return new CustomEvent(ae,{detail:{expression:e,condition:t},bubbles:!0})}(e,t);(null!==n&&void 0!==n?n:document).dispatchEvent(r)};var se=function(e){var t=e.variables,n=e.expression;return{title:"Clone expr",children:[{title:"To All",action:function(){return function(e,t){ue(e,void 0,t)}(n)}},{title:"To Row",action:function(){return function(e,t,n){ue(e,"y === ".concat(t),n)}(n,(null===t||void 0===t?void 0:t.y)||0)}},{title:"To Column",action:function(){return function(e,t,n){ue(e,"x === ".concat(t),n)}(n,(null===t||void 0===t?void 0:t.x)||0)}}]}};var le=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),r=n[0],i=n[1],o=[oe(e),se(e)],a=r.reduce((function(e,t){var n=e[t];return n.children?n.children:e}),o),s=function(e,t){return function(){e.children?i((function(e){return[].concat(Object(ne.a)(e),[t])})):e.action&&e.action()}};return a.map((function(e,t){return Object(L.jsx)(g,{onClick:s(e,t),children:e.title},e.title)}))};var be=function(e){var t=Object(c.useState)(!1),n=Object(u.a)(t,2),r=n[0],i=n[1];return{handleFlip:function(){i((function(e){return!e}))},ContentComponent:r?le:e}};var de,ve=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(c.useEffect)((function(){var n=function(n){var r=n.detail,c=r.condition,i=r.expression;c&&!Object(H.b)(Object(H.c)(c),t)||e(i)};return window.addEventListener("setExpression",n),function(){window.removeEventListener("setExpression",n)}}),[e,t])};function fe(e,t,n){var r=Object(c.useState)(e),i=Object(u.a)(r,2),o=i[0],a=i[1];return[null!==t&&void 0!==t?t:o,null!==n&&void 0!==n?n:a]}var je=Object(f.a)(de||(de=Object(v.a)(["\n  width: calc(100% - 1.3em);\n  position: absolute;\n  bottom: 0.9em;\n  left: 0.6em;\n  font-size: 0.25em;\n"])));var he=function(e){e.init;var t,n,r,i,o,a=e.side,s=void 0===a?100:a,l=e.expression,b=e.setExpression,d=e.variables,v=void 0===d?{}:d,f=e.contentComponent,h=e.useExpressionHook,p=e.logic,m=e.setLogic,x=e.view,w=e.setView,y=fe("0",l,b),C=Object(u.a)(y,2),k=C[0],S=C[1],E=fe("expsyn",p,m),q=Object(u.a)(E,2),R=q[0],M=q[1],F=fe("expsyn",x,w),L=Object(u.a)(F,2),A=L[0],I=L[1],T=(ie[R]||{logic:te}).logic,B=(ie[A]||{view:D}).view,V=be(null!==f&&void 0!==f?f:B),P=V.ContentComponent,z=V.handleFlip,H=(null!==h&&void 0!==h?h:T)(k,S,v),J=H.res,W=H.error,G=H.extra,U=Object(c.useState)(1),K=Object(u.a)(U,2),Q=K[0],X=K[1],Y=J,Z=Y*Q<.5?"#abc":"#444",$=Y*Q>0?(t=Y,{background:"rgba(".concat("170, 187, 204",", ").concat(t,")")}):function(e){return{background:"rgba(0,0,0, ".concat(e,")")}}(-Y);return ve(S,v),Object(O.c)(N,Object(j.a)(Object(j.a)({palette:$,side:s},(n=Q,r=X,i=0,o=1,{onTouchStart:function(){return r(n===o?i:o)}})),{},{children:[Object(O.b)(P,{side:s,expression:k,setExpression:S,res:Y,fontColor:Z,variables:v,error:W,logic:R,setLogic:M,view:A,setView:I,extra:G}),Object(O.b)(g,{css:je,onClick:z,children:"flip"})]}))},Oe=(n(64),Object.keys(ie)[0]),pe=Object.keys(ie)[0];var me=function(e){var t=e.side,n=void 0===t?100:t,r=e.path,i=void 0===r?"/squr":r,o=Object(h.a)(e,["side","path"]),a=Object(s.b)().ref(i),l=Object(s.c)(a),b=l.data,d=l.status,v=Object(c.useState)(void 0),f=Object(u.a)(v,2),O=f[0],p=f[1],m=Object(c.useState)(void 0),x=Object(u.a)(m,2),g=x[0],w=x[1],y=Object(c.useState)(void 0),C=Object(u.a)(y,2),k=C[0],S=C[1],E=function(e,t){return function(n){e(n),a.update(Object(I.a)({},t,n))}},q=E(p,"expr"),R=E(w,"logic"),M=E(S,"view");return Object(c.useEffect)((function(){if("success"===d){var e,t,n,r=null!==(e=b.expr)&&void 0!==e?e:"sin(t)",c=null!==(t=b.logic)&&void 0!==t?t:Oe,i=null!==(n=b.view)&&void 0!==n?n:pe;r!==O&&p(r),c!==g&&w(c),i!==k&&S(i)}}),[d,b]),void 0===O||"success"!==d?Object(L.jsx)(N,{side:n,palette:{background:"black"},children:d}):Object(L.jsx)(he,Object(j.a)({side:n,expression:O,setExpression:q,logic:g,setLogic:R,view:k,setView:M},o),function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"view";return"".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"logic","-").concat(e)}(g,k))},xe=i.a.createContext(0),ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Object(c.useState)(e),n=Object(u.a)(t,2),r=n[0],i=n[1];return B((function(e){return i((function(t){return t+e/1e3}))})),r},we="".concat(20,"vmin"),ye=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return e%t},Ce=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return Math.floor(e/t)},ke=new Array(16).fill(1).map((function(e,t){return Object(L.jsx)(me,{side:we,path:"/squrs/".concat(t),variables:{i:t,i1:t+1,x:ye(t),x1:ye(t)+1,y:Ce(t),y1:Ce(t)+1}},t)}));var Se=function(){var e=ge(),t=Object(c.useState)(!1),n=Object(u.a)(t,2),r=n[0],i=n[1];return Object(L.jsx)(s.a,{firebaseConfig:b,children:Object(L.jsx)(A,{children:Object(L.jsx)(xe.Provider,{value:e,children:Object(L.jsx)("div",{style:{display:"flex",height:"100vh",width:"100vw",alignItems:"center",justifyContent:"center"},children:r?Object(L.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(4,", ").concat(we,")"),gap:"2vmin"},children:[Object(L.jsx)(q,{}),ke]}):Object(L.jsx)(M,{onClick:function(){i(!0),l.f(),l.e.start()}})})})})})},Ee=function(e){e&&e instanceof Function&&n.e(12).then(n.bind(null,74)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),i(e),o(e)}))};a.a.render(Object(L.jsx)(i.a.StrictMode,{children:Object(L.jsx)(Se,{})}),document.getElementById("root")),Ee()}},[[67,3,4]]]);
//# sourceMappingURL=main.3c463707.chunk.js.map