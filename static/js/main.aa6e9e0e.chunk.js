(this.webpackJsonpsqurs=this.webpackJsonpsqurs||[]).push([[2],{46:function(e,t,n){},56:function(e,t,n){},66:function(e,t,n){"use strict";n.r(t);var r,c=n(4),i=n.n(c),a=n(36),o=n.n(a),u=(n(46),n(5)),s=n(26),l=n(11),d=(n(56),{apiKey:"AIzaSyA6miG1egwhyCpNcBdr-R8P3flUJP8VLj4",authDomain:"squr-d2ae8.firebaseapp.com",databaseURL:"https://squr-d2ae8-default-rtdb.europe-west1.firebasedatabase.app",projectId:"squr-d2ae8",storageBucket:"squr-d2ae8.appspot.com",messagingSenderId:"25610237851",appId:"1:25610237851:web:8b825f5e7ab2363cd2533e"}),b=n(37),v=n(15),j=n(16),f=n(2),h=n(10),O=n(8),p=Object(j.a)(r||(r=Object(v.a)(["\n    border-radius: 0.5em;\n    padding: 0.5em;\n    box-sizing: border-box;\n    box-shadow: inset 0em -.2em .5em #abc;\n    background: transparent;\n    color: #abc;\n    border: none;\n    /* transition: all 100ms; */\n\n    &:hover {\n        box-shadow: inset 0em .2em .5em #abc;\n    }\n"])));var m,x,g=function(e){var t=e.children,n=Object(h.a)(e,["children"]);return Object(O.b)("button",Object(f.a)(Object(f.a)({css:p},n),{},{children:t}))},y=Object(j.a)(m||(m=Object(v.a)(["\n    position: fixed;\n    left: 2em;\n    top: 2em;\n"]))),w=Object(j.a)(x||(x=Object(v.a)(["\n    background: rgba(0,0,0, 0.5);\n    color: #abc;\n    border-radius: 0.5em;\n    padding: 1em;\n    pointer-events: none;\n"]))),k=[{title:"t",value:"time in secs"},{title:"i",value:"index of squr - 1, 2, 3..."},{title:"x",value:"x index of squr"},{title:"y",value:"y index of squr"}],C=[{title:"sin(x)",value:"sine with 0-1 cycle input and 0-1 output"},{title:"tri(x)",value:"triangle with 0-1 cycle input and 0-1 output"},{title:"sqr(x, phase?)",value:"square with 0-1 cycle input, optional phase"},{title:"stp(x, a, b, c, ...)",value:"step sequencer with 0-1 cycle input"}],q=function(e){var t=e.map((function(e){var t=e.title,n=e.value;return Object(O.c)("li",{children:[Object(O.c)("strong",{children:[t,":"]})," ",n]},t+n)}));return Object(O.b)("ul",{children:t})};var R,S=function(e){Object(b.a)(e);var t=Object(c.useState)(!0),n=Object(u.a)(t,2),r=n[0],i=n[1],a=Object(O.c)("div",{css:w,children:[Object(O.b)("p",{children:"make the squrs sing and shine with math expressions"}),Object(O.b)("p",{children:"all is syncd, tell friends"}),Object(O.b)("h3",{children:"Variables"}),q(k),Object(O.b)("h3",{children:"Functions"}),q(C)]});return Object(O.c)("div",{css:y,children:[Object(O.b)("div",{children:Object(O.b)(g,{onClick:function(){return i((function(e){return!e}))},children:"?"})}),r&&a]})},M=Object(j.a)(R||(R=Object(v.a)(["\n    color: white;\n    text-align: center;\n"])));var E=function(e){var t=e.onClick;return Object(O.c)("div",{css:M,children:[Object(O.b)("h1",{children:"SQUR!"}),Object(O.b)("div",{children:Object(O.b)(g,{onClick:t,children:"\u25a1\u25a1 start \u25a1\u25a1"})}),Object(O.b)("div",{children:Object(O.b)("small",{children:"gotta make you click to make sounds, aight, domj"})})]})},N=Object(c.createContext)({volume:null}),F=n(7);var A=function(e){var t=e.children,n=Object(c.useRef)(1);return Object(c.useEffect)((function(){return window.setVolume=function(e){return n.current=e},function(){delete window.setVolume}}),[]),Object(F.jsx)(N.Provider,{value:{volume:n},children:t})},I=function(e){return{width:e,height:e}};var P=function(e){var t=e.color,n=e.children,r=e.side,c=e.onContextMenu;return Object(F.jsx)("div",{onContextMenu:c,style:Object(f.a)(Object(f.a)(Object(f.a)({},{borderRadius:"0.5em",padding:"0.5em",boxSizing:"border-box",boxShadow:"inset 0em -.2em .5em #abc"}),I(r)),t),children:n})},B=n(24),D=n(38),z=function(e){var t=i.a.useRef(),n=i.a.useRef(),r=function r(c){if(n.current){var i=c-n.current;e(i)}n.current=c,t.current=requestAnimationFrame(r)};i.a.useEffect((function(){return t.current=requestAnimationFrame(r),function(){return cancelAnimationFrame(t.current)}}),[])};var L,T=function(e){var t=e.value,n=Object(c.useRef)(Array(30).fill(0)),r=Object(c.useState)(n.current),i=Object(u.a)(r,2),a=i[0],o=i[1],s=Object(c.useRef)(0);s.current=t,z((function(){n.current=n.current.slice(1,n.current.length),n.current.push(s.current),o(n.current)}));var l=a.map((function(e,t){return"L".concat(1*t," ").concat(100-(90*Math.abs(e)+5))})).join(" ");return Object(F.jsx)("div",{style:{width:"100%"},children:Object(F.jsx)("svg",{height:"30",width:"100%",viewBox:"0 0 30 100",preserveAspectRatio:"none",children:Object(F.jsx)("path",{d:"M-5 0 ".concat(l),strokeWidth:"2",stroke:"currentColor",fill:"none",vectorEffect:"non-scaling-stroke"})})})},H="C",V="F",W="G",J="Bb",U=[H,"D",V,W,J],G=function(e){var t=U[e%U.length],n=Math.floor(e/U.length);return"".concat(t).concat(n+3)},K=function(e){return Object(B.pipe)(e,Object(D.collect)((function(e,t){return Object(O.c)("span",{children:[Object(O.c)("strong",{children:[" ",e,":"]}),t]})})))},Q=Object(j.a)(L||(L=Object(v.a)(["\n    opacity: 0.3;\n    transition: all 500ms;\n    &:hover {\n        opacity: 1;\n    }\n"])));var X=function(e){var t=e.expression,n=e.setExpression,r=e.res,c=e.fontColor,i=e.variables,a=e.error,o=e.instrumentName;return Object(O.c)(O.a,{children:[Object(O.b)("textarea",{style:{fontFamily:"monospace",borderRadius:"0.3em",padding:"0.5em",boxSizing:"border-box",border:"none",width:"100%",boxShadow:"inset 0em .2em .5em #abc",background:"transparent",color:c,fontWeight:"bold",transition:"all 300ms",maxWidth:"100%",minWidth:"100%",minHeight:"50%",maxHeight:"100%"},value:t,onChange:function(e){return n(e.target.value)}}),Object(O.c)("div",{css:Q,style:{color:c},children:[Object(O.b)(T,{value:r}),Object(O.c)("div",{children:[G((null===i||void 0===i?void 0:i.i)||0),K(i||{})]}),Object(O.b)("div",{style:{color:c,fontSize:"2em"},children:o})]}),a&&Object(O.b)("div",{style:{color:"red"},children:a.description})]})},Y=n(39),Z=function(e){return Math.sin(e*Math.PI*2)/2+.5},$=function(e){return e%1<.5?e%1*2:1-2*(e%1-.5)},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return e%1>t?1:0},ee=function(e){return 1-e},te=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return e*ee(n)+t*n},ne=function(e){var t=arguments.length<=1?0:arguments.length-1,n=Math.floor(e*t)%t;return n+1<1||arguments.length<=n+1?void 0:arguments[n+1]},re=function(e,t,n){var r=Object(c.useContext)(N).volume,i=Object(c.useState)(0),a=Object(u.a)(i,2),o=a[0],s=a[1];z((function(e){s(v.current)}));var d=Object(c.useRef)((function(){return.5})),b=Object(c.useRef)(null);Object(c.useEffect)((function(){try{d.current=Object(Y.a)(e),b.current=null}catch(t){b.current=t}}),[e]);var v=Object(c.useRef)(0);Object(c.useEffect)((function(){var e;return j.current=new l.c({frequency:(e=(null===n||void 0===n?void 0:n.i)||0,l.a(G(e)).toFrequency()),type:"sine",volume:-60,detune:30*Math.random()-15}).toDestination().start(),function(){var e;null===(e=j.current)||void 0===e||e.dispose()}}),[]);var j=Object(c.useRef)(null);return Object(c.useEffect)((function(){var e=new l.b((function(e){var t,c=d.current(Object(f.a)({time:e,t:e,sin:Z,tri:$,sqr:_,stp:ne,inv:ee},n));if(v.current="number"===typeof c?(t=c,Math.max(Math.min(t,1),-1)):0,!isNaN(v.current)&&j.current&&r){var i=0===v.current?-1/0:te(-60,te(-60,-40,r.current),Math.abs(v.current));j.current.volume.rampTo(i,.06,e),j.current.type=v.current>=0?"sine":"square"}}),"0.03").start(0);return function(){var t;null===(t=j.current)||void 0===t||t.dispose(),e.dispose()}}),[]),{res:Math.abs(o),error:b.current,instrumentName:"expsyn"}};var ce=function(e){var t,n=e.init,r=e.side,i=void 0===r?100:r,a=e.expression,o=e.setExpression,s=e.variables,l=void 0===s?{}:s,d=e.toggleInstrument,b=e.contentComponent,v=void 0===b?X:b,j=e.useExpressionHook,f=void 0===j?re:j,h=Object(c.useState)(n||"0"),O=Object(u.a)(h,2),p=O[0],m=O[1],x=null!==a&&void 0!==a?a:p,g=null!==o&&void 0!==o?o:m,y=f(x,g,l),w=y.res,k=y.error,C=y.instrumentName,q=y.extra,R=w<.5?"#abc":"#444",S=w>0?(t=w,{background:"rgba(".concat("170, 187, 204",", ").concat(t,")")}):function(e){return{background:"rgba(0,0,0, ".concat(e,")")}}(-w),M=v;return Object(F.jsx)(P,{color:S,side:i,onContextMenu:function(e){e.preventDefault(),d()},children:Object(F.jsx)(M,{side:i,expression:x,setExpression:g,res:w,fontColor:R,variables:l,error:k,instrumentName:C,extra:q})})},ie=(n(63),n(6)),ae="#abc";function oe(e){var t=e.res,n=e.value,r=e.onClick,c=e.side,i=e.active,a="0";n>=.5&&(a="?"),n>=1&&(a="!");var o=i?ae:"transparent",u=i?"black":t>.5?"rgba(0,0,0,0.1)":"#abc";return Object(F.jsx)(g,{onClick:r,style:{width:c,height:c,background:o,color:u,borderRadius:"100%"},children:a})}var ue={gridseq:{view:function(e){var t=e.res,n=e.expression,r=e.setExpression,c=e.side,i=e.extra,a=(null===i||void 0===i?void 0:i.step)||0,o=n.split(",").map((function(e){var t=+e;return isNaN(t)?0:t}))||[0],u=function(e){!function(e,t){var n=Object(ie.a)(o);n[e]=t,r(n.join(","))}(e,(o[e]+.5)%1.5)},s="calc(".concat(c," / 4 - 5px)"),l=o.map((function(e,n){return Object(F.jsx)(oe,{res:t,active:a===n,side:s,value:e,onClick:function(){return u(n)}},n)}));return Object(F.jsx)("div",{style:{textAlign:"center"},children:l})},logic:function(e,t,n){var r=Object(c.useRef)([0]),i=Object(c.useState)(0),a=Object(u.a)(i,2),o=a[0],s=a[1];Object(c.useEffect)((function(){var n=e.split(",").map((function(e){var t=+e;return isNaN(t)?0:t}));r.current=n||[0],r.current.length<16&&t("0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0")}),[e,t]);var d=Object(c.useState)(0),b=Object(u.a)(d,2),v=b[0],j=b[1],f=Object(c.useRef)(null);return Object(c.useEffect)((function(){f.current=(new l.d).toDestination(),f.current.volume.rampTo(-30,0);var e=new l.b((function(e){var t,c=Math.round(4*e)%r.current.length,i=r.current[c];s(c);var a=i>=Math.random();j(a?1:0),a&&(null===(t=f.current)||void 0===t||t.triggerAttackRelease(G((null===n||void 0===n?void 0:n.i)||0),"8n",e))}),"8n").start(0);return function(){var t;null===(t=f.current)||void 0===t||t.dispose(),e.dispose()}}),[]),{res:v,error:null,instrumentName:"sequencer",extra:{step:o}}}},expsyn:{view:X,logic:re}};var se=function(e){var t,n=e.side,r=void 0===n?100:n,i=e.path,a=void 0===i?"/squr":i,o=Object(h.a)(e,["side","path"]),l=Object(s.b)().ref(a),d=Object(s.c)(l),b=d.data,v=d.status,j=Object(c.useState)(void 0),O=Object(u.a)(j,2),p=O[0],m=O[1];if(Object(c.useEffect)((function(){if("success"===v){var e,t=null!==(e=b.expr)&&void 0!==e?e:"0";t!==p&&m(t)}}),[v,b]),void 0===p||"success"!==v)return Object(F.jsx)(P,{side:r,color:{background:"white"},children:v});var x=null!==(t=b.instrument)&&void 0!==t?t:"expsyn",g=ue[x]||ue.expsyn,y=g.logic,w=g.view;return Object(F.jsx)(ce,Object(f.a)({toggleInstrument:function(){var e="expsyn"===x?"gridseq":"expsyn";l.update({instrument:e})},side:r,expression:p,setExpression:function(e){m(e),l.update({expr:e})},contentComponent:w,useExpressionHook:y},o),x)},le=i.a.createContext(0),de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Object(c.useState)(e),n=Object(u.a)(t,2),r=n[0],i=n[1];return z((function(e){return i((function(t){return t+e/1e3}))})),r},be="".concat(20,"vmin"),ve=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return e%t},je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return Math.round(e/t)},fe=new Array(16).fill(1).map((function(e,t){return Object(F.jsx)(se,{side:be,path:"/squrs/".concat(t),variables:{i:t+1,x:ve(t)+1,y:je(t)+1}},t)}));var he=function(){var e=de(),t=Object(c.useState)(!1),n=Object(u.a)(t,2),r=n[0],i=n[1];return Object(F.jsx)(s.a,{firebaseConfig:d,children:Object(F.jsx)(A,{children:Object(F.jsx)(le.Provider,{value:e,children:Object(F.jsx)("div",{style:{display:"flex",height:"100vh",width:"100vw",alignItems:"center",justifyContent:"center"},children:r?Object(F.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(4,", ").concat(be,")"),gap:"2vmin"},children:[Object(F.jsx)(S,{}),fe]}):Object(F.jsx)(E,{onClick:function(){i(!0),l.f(),l.e.start()}})})})})})},Oe=function(e){e&&e instanceof Function&&n.e(12).then(n.bind(null,73)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),c(e),i(e),a(e)}))};o.a.render(Object(F.jsx)(i.a.StrictMode,{children:Object(F.jsx)(he,{})}),document.getElementById("root")),Oe()}},[[66,3,4]]]);
//# sourceMappingURL=main.aa6e9e0e.chunk.js.map