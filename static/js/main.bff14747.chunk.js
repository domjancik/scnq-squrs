(this.webpackJsonpsqurs=this.webpackJsonpsqurs||[]).push([[2],{46:function(e,t,n){},47:function(e,t,n){},57:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var r,c=n(4),i=n.n(c),o=n(36),a=n.n(o),u=(n(46),n(47),n(5)),s=n(26),l=n(11),d=(n(57),{apiKey:"AIzaSyA6miG1egwhyCpNcBdr-R8P3flUJP8VLj4",authDomain:"squr-d2ae8.firebaseapp.com",databaseURL:"https://squr-d2ae8-default-rtdb.europe-west1.firebasedatabase.app",projectId:"squr-d2ae8",storageBucket:"squr-d2ae8.appspot.com",messagingSenderId:"25610237851",appId:"1:25610237851:web:8b825f5e7ab2363cd2533e"}),b=n(37),v=n(15),f=n(16),j=n(2),h=n(10),p=n(8),O=Object(f.a)(r||(r=Object(v.a)(["\n    border-radius: 0.5em;\n    padding: 0.5em;\n    box-sizing: border-box;\n    box-shadow: inset 0em -.2em .5em #abc;\n    background: transparent;\n    color: #abc;\n    border: none;\n    font-family: 'JetBrains Mono', monospace;\n\n    /* transition: all 100ms; */\n\n    &:hover {\n        box-shadow: inset 0em .2em .5em #abc;\n    }\n"])));var m,x,g=function(e){var t=e.children,n=Object(h.a)(e,["children"]);return Object(p.b)("button",Object(j.a)(Object(j.a)({css:O},n),{},{children:t}))},y=Object(f.a)(m||(m=Object(v.a)(["\n    position: fixed;\n    left: 2em;\n    top: 2em;\n"]))),w=Object(f.a)(x||(x=Object(v.a)(["\n    background: rgba(0,0,0, 0.5);\n    color: #abc;\n    border-radius: 0.5em;\n    padding: 1em;\n    pointer-events: none;\n"]))),k=[{title:"t",value:"time in secs"},{title:"i",value:"index of squr - 0, 1, 2... use i1 for 1-indexed"},{title:"x",value:"x index of squr, use x1 for 1-indexed"},{title:"y",value:"y index of squr, use y1 for 1-indexed"}],C=[{title:"sin(x)",value:"sine with 0-1 cycle input and 0-1 output"},{title:"tri(x)",value:"triangle with 0-1 cycle input and 0-1 output"},{title:"sqr(x, phase?)",value:"square with 0-1 cycle input, optional phase"},{title:"stp(x, a, b, c, ...)",value:"step sequencer with 0-1 cycle input"}],q=function(e){var t=e.map((function(e){var t=e.title,n=e.value;return Object(p.c)("li",{children:[Object(p.c)("strong",{children:[t,":"]})," ",n]},t+n)}));return Object(p.b)("ul",{children:t})};var M,R=function(e){Object(b.a)(e);var t=Object(c.useState)(!1),n=Object(u.a)(t,2),r=n[0],i=n[1],o=Object(p.c)("div",{css:w,children:[Object(p.b)("p",{children:"make the squrs sing and shine with math expressions and clicks"}),Object(p.b)("p",{children:"all is syncd, tell friends"}),Object(p.b)("p",{children:"RIGHT CLICK switches instruments"}),Object(p.b)("h3",{children:"Variables"}),q(k),Object(p.b)("h3",{children:"Functions"}),q(C)]});return Object(p.c)("div",{css:y,children:[Object(p.b)("div",{children:Object(p.b)(g,{onClick:function(){return i((function(e){return!e}))},children:"Help pls"})}),r&&o]})},S=Object(f.a)(M||(M=Object(v.a)(["\n    color: white;\n    text-align: center;\n"])));var E=function(e){var t=e.onClick;return Object(p.c)("div",{css:S,children:[Object(p.b)("h1",{children:"SQUR!"}),Object(p.b)("div",{children:Object(p.b)(g,{onClick:t,children:"\u25a1\u25a1 start \u25a1\u25a1"})}),Object(p.b)("div",{children:Object(p.b)("small",{children:"gotta make you click to make sounds, aight, domj"})})]})},I=Object(c.createContext)({volume:null}),N=n(7);var F=function(e){var t=e.children,n=Object(c.useRef)(1);return Object(c.useEffect)((function(){return window.setVolume=function(e){return n.current=e},function(){delete window.setVolume}}),[]),Object(N.jsx)(I.Provider,{value:{volume:n},children:t})},A=function(e){return{width:e,height:e}};var B=function(e){var t=e.color,n=e.children,r=e.side,c=e.onContextMenu;return Object(N.jsx)("div",{onContextMenu:c,style:Object(j.a)(Object(j.a)(Object(j.a)({},{borderRadius:"0.5em",padding:"0.5em",boxSizing:"border-box",boxShadow:"inset 0em -.2em .5em #abc"}),A(r)),t),children:n})},P=n(24),z=n(38),D=function(e){var t=i.a.useRef(),n=i.a.useRef(),r=function r(c){if(n.current){var i=c-n.current;e(i)}n.current=c,t.current=requestAnimationFrame(r)};i.a.useEffect((function(){return t.current=requestAnimationFrame(r),function(){return cancelAnimationFrame(t.current)}}),[])};var H,L=function(e){var t=e.value,n=Object(c.useRef)(Array(30).fill(0)),r=Object(c.useState)(n.current),i=Object(u.a)(r,2),o=i[0],a=i[1],s=Object(c.useRef)(0);s.current=t,D((function(){n.current=n.current.slice(1,n.current.length),n.current.push(s.current),a(n.current)}));var l=o.map((function(e,t){return"L".concat(1*t," ").concat(100-(90*Math.abs(e)+5))})).join(" ");return Object(N.jsx)("div",{style:{width:"100%"},children:Object(N.jsx)("svg",{height:"30",width:"100%",viewBox:"0 0 30 100",preserveAspectRatio:"none",children:Object(N.jsx)("path",{d:"M-5 0 ".concat(l),strokeWidth:"2",stroke:"currentColor",fill:"none",vectorEffect:"non-scaling-stroke"})})})},T="C",J="F",V="G",W="Bb",G=[T,"D",J,V,W],U=function(e){var t=G[e%G.length],n=Math.floor(e/G.length);return"".concat(t).concat(n+3)},K=function(e){return Object(P.pipe)(e,Object(z.collect)((function(e,t){return Object(p.c)("span",{children:[Object(p.c)("strong",{children:[" ",e,":"]}),t]})})))},Q=Object(f.a)(H||(H=Object(v.a)(["\n  opacity: 0.3;\n  transition: all 500ms;\n  &:hover {\n    opacity: 1;\n  }\n"])));var X=function(e){var t=e.expression,n=e.setExpression,r=e.res,c=e.fontColor,i=e.variables,o=e.error,a=e.instrumentName;return Object(p.c)(p.a,{children:[Object(p.b)("textarea",{style:{fontFamily:"JetBrains Mono, monospace",borderRadius:"0.3em",padding:"0.5em",boxSizing:"border-box",border:"none",width:"100%",boxShadow:"inset 0em .2em .5em #abc",background:"transparent",color:c,fontWeight:"bold",transition:"all 300ms",maxWidth:"100%",minWidth:"100%",minHeight:"50%",maxHeight:"100%"},value:t,onChange:function(e){return n(e.target.value)}}),Object(p.c)("div",{css:Q,style:{color:c,fontSize:"0.5em"},children:[Object(p.b)(L,{value:r}),Object(p.c)("div",{children:["Note: ",U((null===i||void 0===i?void 0:i.i)||0),", Vars:"," ",K(i||{})]}),Object(p.c)("div",{style:{color:c,fontSize:"0.5em"},children:["Instrument: ",a]})]}),o&&Object(p.b)("div",{style:{color:"red"},children:o.description})]})},Y=n(39),Z=function(e){return Math.sin(e*Math.PI*2)/2+.5},$=function(e){return e%1<.5?e%1*2:1-2*(e%1-.5)},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return e%1>t?1:0},ee=function(e){return 1-e},te=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return e*ee(n)+t*n},ne=function(e){var t=arguments.length<=1?0:arguments.length-1,n=Math.floor(e*t)%t;return n+1<1||arguments.length<=n+1?void 0:arguments[n+1]},re=function(e,t,n){var r=Object(c.useContext)(I).volume,i=Object(c.useState)(0),o=Object(u.a)(i,2),a=o[0],s=o[1];D((function(e){s(v.current)}));var d=Object(c.useRef)((function(){return.5})),b=Object(c.useRef)(null);Object(c.useEffect)((function(){try{d.current=Object(Y.a)(e),b.current=null}catch(t){b.current=t}}),[e]);var v=Object(c.useRef)(0);Object(c.useEffect)((function(){var e;return f.current=new l.c({frequency:(e=(null===n||void 0===n?void 0:n.i)||0,l.a(U(e)).toFrequency()),type:"sine",volume:-60,detune:30*Math.random()-15}).toDestination().start(),function(){var e;null===(e=f.current)||void 0===e||e.dispose()}}),[]);var f=Object(c.useRef)(null);return Object(c.useEffect)((function(){var e=new l.b((function(e){var t,c=d.current(Object(j.a)({time:e,t:e,sin:Z,tri:$,sqr:_,stp:ne,inv:ee},n));if(v.current="number"===typeof c?(t=c,Math.max(Math.min(t,1),-1)):0,!isNaN(v.current)&&f.current&&r){var i=0===v.current?-1/0:te(-60,te(-60,-40,r.current),Math.abs(v.current));f.current.volume.rampTo(i,.06,e),f.current.type=v.current>=0?"sine":"square"}}),"0.03").start(0);return function(){var t;null===(t=f.current)||void 0===t||t.dispose(),e.dispose()}}),[]),{res:Math.abs(a),error:b.current,instrumentName:"expsyn"}};var ce=function(e){var t,n=e.init,r=e.side,i=void 0===r?100:r,o=e.expression,a=e.setExpression,s=e.variables,l=void 0===s?{}:s,d=e.toggleInstrument,b=e.contentComponent,v=void 0===b?X:b,f=e.useExpressionHook,j=void 0===f?re:f,h=Object(c.useState)(n||"0"),p=Object(u.a)(h,2),O=p[0],m=p[1],x=null!==o&&void 0!==o?o:O,g=null!==a&&void 0!==a?a:m,y=j(x,g,l),w=y.res,k=y.error,C=y.instrumentName,q=y.extra,M=w<.5?"#abc":"#444",R=w>0?(t=w,{background:"rgba(".concat("170, 187, 204",", ").concat(t,")")}):function(e){return{background:"rgba(0,0,0, ".concat(e,")")}}(-w),S=v;return Object(N.jsx)(B,{color:R,side:i,onContextMenu:function(e){e.preventDefault(),d()},children:Object(N.jsx)(S,{side:i,expression:x,setExpression:g,res:w,fontColor:M,variables:l,error:k,instrumentName:C,extra:q})})},ie=(n(64),n(6)),oe="#abc";function ae(e){var t=e.res,n=e.value,r=e.onClick,c=e.side,i=e.active,o="0";n>=.5&&(o="?"),n>=1&&(o="!");var a=i?oe:"transparent",u=i?"black":t>.5?"rgba(0,0,0,0.1)":"#abc";return Object(N.jsx)(g,{onClick:r,style:{width:c,height:c,background:a,color:u,borderRadius:"100%"},children:o})}var ue={gridseq:{view:function(e){var t=e.res,n=e.expression,r=e.setExpression,c=e.side,i=e.extra,o=(null===i||void 0===i?void 0:i.step)||0,a=n.split(",").map((function(e){var t=+e;return isNaN(t)?0:t}))||[0],u=function(e){!function(e,t){var n=Object(ie.a)(a);n[e]=t,r(n.join(","))}(e,(a[e]+.5)%1.5)},s="calc(".concat(c," / 4 - 5px)"),l=a.map((function(e,n){return Object(N.jsx)(ae,{res:t,active:o===n,side:s,value:e,onClick:function(){return u(n)}},n)}));return Object(N.jsx)("div",{style:{textAlign:"center"},children:l})},logic:function(e,t,n){var r=Object(c.useRef)([0]),i=Object(c.useState)(0),o=Object(u.a)(i,2),a=o[0],s=o[1];Object(c.useEffect)((function(){var n=e.split(",").map((function(e){var t=+e;return isNaN(t)?0:t}));r.current=n||[0],r.current.length<16&&t("0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0")}),[e,t]);var d=Object(c.useState)(0),b=Object(u.a)(d,2),v=b[0],f=b[1],j=Object(c.useRef)(null);return Object(c.useEffect)((function(){j.current=(new l.d).toDestination(),j.current.volume.rampTo(-30,0);var e=new l.b((function(e){var t,c=Math.round(4*e)%r.current.length,i=r.current[c];s(c);var o=i>=Math.random();f(o?1:0),o&&(null===(t=j.current)||void 0===t||t.triggerAttackRelease(U((null===n||void 0===n?void 0:n.i)||0),"8n",e))}),"8n").start(0);return function(){var t;null===(t=j.current)||void 0===t||t.dispose(),e.dispose()}}),[]),{res:v,error:null,instrumentName:"sequencer",extra:{step:a}}}},expsyn:{view:X,logic:re}};var se=function(e){var t,n=e.side,r=void 0===n?100:n,i=e.path,o=void 0===i?"/squr":i,a=Object(h.a)(e,["side","path"]),l=Object(s.b)().ref(o),d=Object(s.c)(l),b=d.data,v=d.status,f=Object(c.useState)(void 0),p=Object(u.a)(f,2),O=p[0],m=p[1];if(Object(c.useEffect)((function(){if("success"===v){var e,t=null!==(e=b.expr)&&void 0!==e?e:"0";t!==O&&m(t)}}),[v,b]),void 0===O||"success"!==v)return Object(N.jsx)(B,{side:r,color:{background:"white"},children:v});var x=null!==(t=b.instrument)&&void 0!==t?t:"expsyn",g=ue[x]||ue.expsyn,y=g.logic,w=g.view;return Object(N.jsx)(ce,Object(j.a)({toggleInstrument:function(){var e="expsyn"===x?"gridseq":"expsyn";l.update({instrument:e})},side:r,expression:O,setExpression:function(e){m(e),l.update({expr:e})},contentComponent:w,useExpressionHook:y},a),x)},le=i.a.createContext(0),de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Object(c.useState)(e),n=Object(u.a)(t,2),r=n[0],i=n[1];return D((function(e){return i((function(t){return t+e/1e3}))})),r},be="".concat(20,"vmin"),ve=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return e%t},fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return Math.round(e/t)},je=new Array(16).fill(1).map((function(e,t){return Object(N.jsx)(se,{side:be,path:"/squrs/".concat(t),variables:{i:t,i1:t+1,x:ve(t),x1:ve(t)+1,y:fe(t),y1:fe(t)+1}},t)}));var he=function(){var e=de(),t=Object(c.useState)(!1),n=Object(u.a)(t,2),r=n[0],i=n[1];return Object(N.jsx)(s.a,{firebaseConfig:d,children:Object(N.jsx)(F,{children:Object(N.jsx)(le.Provider,{value:e,children:Object(N.jsx)("div",{style:{display:"flex",height:"100vh",width:"100vw",alignItems:"center",justifyContent:"center"},children:r?Object(N.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(4,", ").concat(be,")"),gap:"2vmin"},children:[Object(N.jsx)(R,{}),je]}):Object(N.jsx)(E,{onClick:function(){i(!0),l.f(),l.e.start()}})})})})})},pe=function(e){e&&e instanceof Function&&n.e(12).then(n.bind(null,74)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),i(e),o(e)}))};a.a.render(Object(N.jsx)(i.a.StrictMode,{children:Object(N.jsx)(he,{})}),document.getElementById("root")),pe()}},[[67,3,4]]]);
//# sourceMappingURL=main.bff14747.chunk.js.map